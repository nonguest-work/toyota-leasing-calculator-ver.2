<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Toyota Leasing Calculator - ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡πÄ‡∏ä‡πà‡∏≤‡∏ã‡∏∑‡πâ‡∏≠‡∏£‡∏ñ‡πÇ‡∏ï‡πÇ‡∏¢‡∏ï‡πâ‡∏≤</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            background: linear-gradient(135deg, #d32f2f, #f44336);
            color: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(211, 47, 47, 0.3);
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .form-section, .result-section {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }

        .form-section h2, .result-section h2 {
            color: #d32f2f;
            margin-bottom: 20px;
            font-size: 1.5rem;
            border-bottom: 3px solid #d32f2f;
            padding-bottom: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }

        .form-group select, .form-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .form-group select:focus, .form-group input:focus {
            outline: none;
            border-color: #d32f2f;
            box-shadow: 0 0 0 3px rgba(211, 47, 47, 0.1);
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
            transition: background 0.3s ease;
        }

        .checkbox-item:hover {
            background: #e3f2fd;
        }

        .checkbox-item input[type="checkbox"] {
            margin-right: 10px;
            transform: scale(1.2);
        }

        .calculate-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #d32f2f, #f44336);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            margin-top: 20px;
        }

        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(211, 47, 47, 0.3);
        }

        .result-card {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 5px solid #d32f2f;
        }

        .result-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #dee2e6;
        }

        .result-row:last-child {
            border-bottom: none;
        }

        .result-label {
            font-weight: 600;
            color: #555;
        }

        .result-value {
            font-weight: 700;
            color: #d32f2f;
            font-size: 1.1rem;
        }

        .highlight {
            background: linear-gradient(135deg, #fff3e0, #ffe0b2);
            border-left-color: #ff9800;
        }

        .budget-analysis {
            background: linear-gradient(135deg, #f3e5f5, #e1bee7);
            border-left-color: #9c27b0;
            margin: 15px 0;
        }

        .budget-surplus {
            background: linear-gradient(135deg, #e8f5e8, #c8e6c9);
            border-left-color: #4caf50;
        }

        .budget-deficit {
            background: linear-gradient(135deg, #ffebee, #ffcdd2);
            border-left-color: #f44336;
        }

        .promotions-section {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            margin-top: 30px;
        }

        .promo-card {
            background: linear-gradient(135deg, #e8f5e8, #c8e6c9);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 5px solid #4caf50;
        }

        .promo-title {
            font-weight: 700;
            color: #2e7d32;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .promo-details {
            color: #555;
            line-height: 1.5;
        }

        .error-message {
            background: #ffebee;
            color: #c62828;
            padding: 15px;
            border-radius: 8px;
            border-left: 5px solid #c62828;
            margin-top: 20px;
        }

        .success-message {
            background: #e8f5e8;
            color: #2e7d32;
            padding: 15px;
            border-radius: 8px;
            border-left: 5px solid #4caf50;
            margin-top: 20px;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .checkbox-group {
                grid-template-columns: 1fr;
            }
        }

        .info-icon {
            display: inline-block;
            width: 20px;
            height: 20px;
            background: #2196f3;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 20px;
            font-size: 12px;
            margin-left: 5px;
            cursor: help;
        }

        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 250px;
            background-color: #555;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -125px;
            font-size: 14px;
            line-height: 1.3;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
        }

        .percentage-display {
            font-size: 0.9rem;
            color: #666;
            margin-top: 5px;
        }

        .budget-impact {
            font-size: 1.1rem;
            font-weight: 700;
            text-align: center;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöó Toyota Leasing Calculator</h1>
            <p>‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡πÄ‡∏ä‡πà‡∏≤‡∏ã‡∏∑‡πâ‡∏≠‡∏£‡∏ñ‡πÇ‡∏ï‡πÇ‡∏¢‡∏ï‡πâ‡∏≤ ‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô 2568</p>
        </div>

        <div class="main-content">
            <div class="form-section">
                <h2>üìù ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</h2>
                
                <div class="form-group">
                    <label for="carModel">‡∏£‡∏∏‡πà‡∏ô‡∏£‡∏ñ:</label>
                    <select id="carModel" onchange="updateAvailableTerms()">
                        <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∏‡πà‡∏ô‡∏£‡∏ñ --</option>
                        <option value="Ativ">Toyota Ativ</option>
                        <option value="Yaris">Toyota Yaris</option>
                        <option value="Yaris_Cross">Toyota Yaris Cross</option>
                        <option value="Veloz">Toyota Veloz</option>
                        <option value="Corolla_Cross">Toyota Corolla Cross</option>
                        <option value="Corolla_Altis">Toyota Corolla Altis</option>
                        <option value="Camry">Toyota Camry</option>
                        <option value="Fortuner">Toyota Fortuner</option>
                        <option value="Innova">Toyota Innova</option>
                        <option value="Revo_BCab">Toyota Revo Standard (B-Cab)</option>
                        <option value="Revo_CCab">Toyota Revo Smartcab (C-Cab)</option>
                        <option value="Revo_DCab">Toyota Revo Doublecab (D-Cab)</option>
                        <option value="Hilux_Champ">Toyota Hilux Champ</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="carPrice">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ñ (‡∏ö‡∏≤‡∏ó):</label>
                    <input type="number" id="carPrice" placeholder="‡πÄ‡∏ä‡πà‡∏ô 600000" min="50000" step="1000">
                </div>

                <div class="form-group">
                    <label for="downPayment">‡∏á‡∏ö‡∏î‡∏≤‡∏ß‡∏ô‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ (‡∏ö‡∏≤‡∏ó):</label>
                    <input type="number" id="downPayment" placeholder="‡πÄ‡∏ä‡πà‡∏ô 80000" min="0" step="1000" oninput="updateDownPaymentPercentage()">
                    <div class="percentage-display" id="downPaymentPercentage"></div>
                    <div class="tooltip">
                        <span class="info-icon">?</span>
                        <span class="tooltiptext">‡∏£‡∏∞‡∏ö‡∏∏‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏î‡∏≤‡∏ß‡∏ô‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏´‡∏≤‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ (5%, 10%, 15%, 20%, 25%) ‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏û‡∏≠</span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="loanTerm">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏á‡∏ß‡∏î (‡πÄ‡∏î‡∏∑‡∏≠‡∏ô):</label>
                    <select id="loanTerm">
                        <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏á‡∏ß‡∏î --</option>
                        <option value="48">48 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (4 ‡∏õ‡∏µ)</option>
                        <option value="60">60 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (5 ‡∏õ‡∏µ)</option>
                        <option value="72">72 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (6 ‡∏õ‡∏µ)</option>
                        <option value="84">84 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (7 ‡∏õ‡∏µ)</option>
                        <option value="96">96 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (8 ‡∏õ‡∏µ)</option>
                        <option value="108">108 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (9 ‡∏õ‡∏µ)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="monthlyPayment">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ú‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ (‡∏ö‡∏≤‡∏ó/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô) - ‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö:</label>
                    <input type="number" id="monthlyPayment" placeholder="‡πÄ‡∏ä‡πà‡∏ô 15000" min="1000" step="100">
                    <div class="tooltip">
                        <span class="info-icon">?</span>
                        <span class="tooltiptext">‡∏´‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ú‡πà‡∏≠‡∏ô ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°</span>
                    </div>
                </div>

                <div class="form-group">
                    <label>‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏û‡∏¥‡πÄ‡∏®‡∏©:</label>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="promo_ativ_yaris" value="Ativ_Yaris_2566">
                            <label for="promo_ativ_yaris">Ativ/Yaris 2566 (‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î 0%)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="promo_fortuner" value="Fortuner_2567">
                            <label for="promo_fortuner">Fortuner 2567 (‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î 0.89%)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="promo_veloz" value="Veloz_Special">
                            <label for="promo_veloz">Veloz Special (‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î 0%)</label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤:</label>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="customer_tlt" value="TLT_A_Grade">
                            <label for="customer_tlt">TLT A-Grade (‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î 0.20%)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="customer_kubota" value="Kubota_A_Grade">
                            <label for="customer_kubota">Kubota A-Grade (‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î 0.20%)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="customer_buy_more" value="Buy_More">
                            <label for="customer_buy_more">Buy More (‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î 0.15%)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="customer_buy_easy" value="Buy_Easy">
                            <label for="customer_buy_easy">Buy Easy (‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î 0.15%)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="customer_household" value="Household">
                            <label for="customer_household">Household (‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î 0.15%)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="customer_special" value="Special_Profession">
                            <label for="customer_special">‡∏≠‡∏≤‡∏ä‡∏µ‡∏û‡∏û‡∏¥‡πÄ‡∏®‡∏© (‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î 0.30%)</label>
                        </div>
                    </div>
                </div>

                <button class="calculate-btn" onclick="calculateFinancing()">üßÆ ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</button>
            </div>

            <div class="result-section">
                <h2>üìä ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</h2>
                <div id="results">
                    <div class="result-card">
                        <p style="text-align: center; color: #666; padding: 40px;">
                            üîç ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏Å‡∏î‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <div class="promotions-section">
            <h2>üéâ ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡πÅ‡∏•‡∏∞‡πÅ‡∏Ñ‡∏°‡πÄ‡∏õ‡∏ç‡∏û‡∏¥‡πÄ‡∏®‡∏©</h2>
            <div id="promotions-list">
                <!-- ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÇ‡∏´‡∏•‡∏î‡∏î‡πâ‡∏ß‡∏¢ JavaScript -->
            </div>
        </div>
    </div>

    <script>
        // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∞‡∏ö‡∏ö Toyota Leasing
        const ToyotaLeasingSystem = {
            info: {
                title: "‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô 2568",
                company: "‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡πÇ‡∏ï‡πÇ‡∏¢‡∏ï‡πâ‡∏≤‡∏•‡∏µ‡∏™‡∏ã‡∏¥‡πà‡∏á (‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢) ‡∏à‡∏≥‡∏Å‡∏±‡∏î",
                period: "1-30 ‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô 2568"
            },
            
            standardRates: {
                "Ativ": {
                    "5%": { "48": 4.19, "60": 4.49, "72": 4.95, "84": 5.39 },
                    "10%": { "48": 3.79, "60": 4.09, "72": 4.45, "84": 5.05 },
                    "15%": { "48": 2.99, "60": 3.39, "72": 3.85, "84": 4.25, "96": 4.75 },
                    "20%": { "48": 2.69, "60": 3.05, "72": 3.29, "84": 3.79, "96": 4.29 },
                    "25%": { "48": 2.39, "60": 2.89, "72": 3.15, "84": 3.69, "96": 4.19 }
                },
                "Yaris": {
                    "5%": { "48": 4.19, "60": 4.49, "72": 4.95, "84": 5.39 },
                    "10%": { "48": 3.79, "60": 4.09, "72": 4.45, "84": 5.05 },
                    "15%": { "48": 2.99, "60": 3.39, "72": 3.85, "84": 4.25, "96": 4.75 },
                    "20%": { "48": 2.69, "60": 3.05, "72": 3.29, "84": 3.79, "96": 4.29 },
                    "25%": { "48": 2.39, "60": 2.89, "72": 3.15, "84": 3.69, "96": 4.19 }
                },
                "Yaris_Cross": {
                    "5%": { "48": 3.69, "60": 3.99, "72": 4.45, "84": 4.89 },
                    "10%": { "48": 3.29, "60": 3.59, "72": 3.95, "84": 4.55 },
                    "15%": { "48": 2.49, "60": 2.89, "72": 3.35, "84": 3.75, "96": 4.25 },
                    "20%": { "48": 1.99, "60": 2.35, "72": 2.55, "84": 3.05, "96": 3.79 },
                    "25%": { "48": 1.75, "60": 2.19, "72": 2.45, "84": 2.99, "96": 3.69 }
                },
                "Veloz": {
                    "5%": { "48": 2.25, "60": 2.85, "72": 3.50, "84": 4.09 },
                    "10%": { "48": 1.75, "60": 2.40, "72": 2.95, "84": 3.70 },
                    "15%": { "48": 0.90, "60": 1.65, "72": 2.30, "84": 2.90 },
                    "20%": { "48": 0.39, "60": 1.15, "72": 1.65, "84": 2.30 },
                    "25%": { "48": 0, "60": 0, "72": 1.45, "84": 2.09 }
                },
                "Corolla_Cross": {
                    "5%": { "48": 3.40, "60": 3.90, "72": 4.35, "84": 4.95 },
                    "10%": { "48": 3.00, "60": 3.40, "72": 3.89, "84": 4.55 },
                    "15%": { "48": 2.20, "60": 2.75, "72": 3.29, "84": 3.79 },
                    "20%": { "48": 1.79, "60": 2.29, "72": 2.60, "84": 3.19 },
                    "25%": { "48": 1.39, "60": 2.09, "72": 2.49, "84": 2.99 }
                },
                "Corolla_Altis": {
                    "5%": { "48": 4.09, "60": 4.45, "72": 4.85, "84": 5.39 },
                    "10%": { "48": 3.69, "60": 3.99, "72": 4.39, "84": 4.99 },
                    "15%": { "48": 2.95, "60": 3.35, "72": 3.79, "84": 4.19, "96": 4.69 },
                    "20%": { "48": 2.65, "60": 2.99, "72": 3.25, "84": 3.75, "96": 4.25 },
                    "25%": { "48": 2.39, "60": 2.85, "72": 3.09, "84": 3.59, "96": 4.09 }
                },
                "Camry": {
                    "5%": { "48": 3.70, "60": 4.25, "72": 4.60, "84": 5.15 },
                    "10%": { "48": 3.30, "60": 3.65, "72": 4.10, "84": 4.75 },
                    "15%": { "48": 2.55, "60": 3.00, "72": 3.50, "84": 3.95 },
                    "20%": { "48": 2.20, "60": 2.65, "72": 3.00, "84": 3.55 },
                    "25%": { "48": 1.79, "60": 2.50, "72": 2.80, "84": 3.35 }
                },
                "Fortuner": {
                    "5%": { "48": 2.95, "60": 3.50, "72": 4.00, "84": 4.65 },
                    "10%": { "48": 2.50, "60": 3.00, "72": 3.49, "84": 4.19 },
                    "15%": { "48": 1.70, "60": 2.30, "72": 2.89, "84": 3.39, "96": 3.95 },
                    "20%": { "48": 1.35, "60": 1.85, "72": 2.25, "84": 2.79, "96": 3.50 },
                    "25%": { "48": 0.89, "60": 1.65, "72": 2.05, "84": 2.65, "96": 3.25 }
                },
                "Innova": {
                    "5%": { "48": 3.65, "60": 4.20, "72": 4.55, "84": 5.09 },
                    "10%": { "48": 3.25, "60": 3.60, "72": 4.05, "84": 4.69 },
                    "15%": { "48": 2.50, "60": 2.95, "72": 3.45, "84": 3.89 },
                    "20%": { "48": 2.15, "60": 2.60, "72": 2.90, "84": 3.40 },
                    "25%": { "48": 1.79, "60": 2.50, "72": 2.70, "84": 3.25 }
                },
                "Revo_BCab": {
                    "5%": { "48": 5.05, "60": 5.35, "72": 5.45, "84": 5.55 },
                    "10%": { "48": 4.20, "60": 4.40, "72": 5.05, "84": 5.49 },
                    "15%": { "48": 3.65, "60": 3.95, "72": 4.45, "84": 5.19, "96": 5.69 },
                    "20%": { "48": 2.85, "60": 3.49, "72": 3.95, "84": 4.65, "96": 5.15 },
                    "25%": { "48": 2.39, "60": 3.39, "72": 3.69, "84": 4.49, "96": 4.99 }
                },
                "Revo_CCab": {
                    "5%": { "48": 4.90, "60": 5.25, "72": 5.45, "84": 5.55 },
                    "10%": { "48": 4.10, "60": 4.35, "72": 4.90, "84": 5.40 },
                    "15%": { "48": 3.55, "60": 3.85, "72": 4.30, "84": 5.00, "96": 5.50 },
                    "20%": { "48": 2.80, "60": 3.40, "72": 3.80, "84": 4.50, "96": 5.00 },
                    "25%": { "48": 2.39, "60": 3.30, "72": 3.60, "84": 4.30, "96": 4.80 }
                },
                "Revo_DCab": {
                    "5%": { "48": 4.80, "60": 5.15, "72": 5.45, "84": 5.55 },
                    "10%": { "48": 4.00, "60": 4.30, "72": 4.75, "84": 5.45 },
                    "15%": { "48": 3.45, "60": 3.75, "72": 4.19, "84": 4.85, "96": 5.35 },
                    "20%": { "48": 2.75, "60": 3.29, "72": 3.65, "84": 4.35, "96": 4.85 },
                    "25%": { "48": 2.39, "60": 3.19, "72": 3.49, "84": 4.09, "96": 4.59 }
                },
                "Hilux_Champ": {
                    "5%": { "48": 4.90, "60": 5.25, "72": 5.30, "84": 5.50, "96": 5.80, "108": 6.30 },
                    "10%": { "48": 4.09, "60": 4.29, "72": 4.89, "84": 5.30, "96": 5.65, "108": 5.70 },
                    "15%": { "48": 3.59, "60": 3.89, "72": 4.35, "84": 5.00, "96": 5.50, "108": 5.70 },
                    "20%": { "48": 2.85, "60": 3.49, "72": 3.89, "84": 4.55, "96": 5.05, "108": 5.55 },
                    "25%": { "48": 2.39, "60": 3.39, "72": 3.69, "84": 4.45, "96": 4.95, "108": 5.45 }
                }
            },
            
            specialPromotions: {
                "Ativ_Yaris_2566": {
                    description: "‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏û‡∏¥‡πÄ‡∏®‡∏©‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏ñ‡πÄ‡∏≠‡∏ó‡∏µ‡∏ü‡πÉ‡∏´‡∏°‡πà ‡πÅ‡∏•‡∏∞‡∏¢‡∏≤‡∏£‡∏¥‡∏™ ‡∏õ‡∏µ 2566",
                    models: ["Ativ", "Yaris"],
                    period: "1-30 ‡∏°‡∏¥.‡∏¢. 2568",
                    deliveryDeadline: "31 ‡∏Å.‡∏Ñ. 2568",
                    dealerSubsidy: 9000,
                    lowestRate: 0,
                    conditions: "‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î 0% ‡∏ó‡∏µ‡πà‡∏î‡∏≤‡∏ß‡∏ô‡πå 25% ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ 48 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô",
                    rates: {
                        "5%": { "48": 2.60, "60": 3.20, "72": 3.80, "84": 4.39 },
                        "10%": { "48": 2.15, "60": 2.70, "72": 3.25, "84": 4.00 },
                        "15%": { "48": 1.30, "60": 1.95, "72": 2.60, "84": 3.20, "96": 3.75 },
                        "20%": { "48": 0.79, "60": 1.45, "72": 1.85, "84": 2.50, "96": 3.29 },
                        "25%": { "48": 0, "60": 1.25, "72": 1.69, "84": 2.30, "96": 3.05 }
                    }
                },
                "Fortuner_2567": {
                    description: "‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏û‡∏¥‡πÄ‡∏®‡∏©‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏ñ‡∏ü‡∏≠‡∏£‡πå‡∏à‡∏π‡∏ô‡πÄ‡∏ô‡∏≠‡∏£‡πå ‡∏õ‡∏µ 2567",
                    models: ["Fortuner"],
                    period: "1-30 ‡∏°‡∏¥.‡∏¢. 2568",
                    deliveryDeadline: "31 ‡∏Å.‡∏Ñ. 2568",
                    dealerSubsidy: { "Leader": 17000, "Legender_GR_Sport": 37000 },
                    lowestRate: 0.89,
                    conditions: "‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î 0.89% ‡∏ó‡∏µ‡πà‡∏î‡∏≤‡∏ß‡∏ô‡πå 25% ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ 48 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô",
                    rates: {
                        "5%": { "48": 2.95, "60": 3.50, "72": 4.00, "84": 4.65 },
                        "10%": { "48": 2.50, "60": 3.00, "72": 3.49, "84": 4.19 },
                        "15%": { "48": 1.70, "60": 2.30, "72": 2.89, "84": 3.39, "96": 3.95 },
                        "20%": { "48": 1.35, "60": 1.85, "72": 2.25, "84": 2.79, "96": 3.50 },
                        "25%": { "48": 0.89, "60": 1.65, "72": 2.05, "84": 2.65, "96": 3.25 }
                    }
                },
                "Veloz_Special": {
                    description: "‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏û‡∏¥‡πÄ‡∏®‡∏©‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏ñ‡πÄ‡∏ß‡∏•‡∏≠‡∏ã",
                    models: ["Veloz"],
                    period: "1 ‡∏°‡∏µ.‡∏Ñ. - 30 ‡∏°‡∏¥.‡∏¢. 2568",
                    deliveryDeadline: "31 ‡∏Å.‡∏Ñ. 2568",
                    dealerSubsidy: 9000,
                    lowestRate: 0,
                    conditions: "‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î 0% ‡∏ó‡∏µ‡πà‡∏î‡∏≤‡∏ß‡∏ô‡πå 25% ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ 60 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô",
                    rates: {
                        "5%": { "48": 2.25, "60": 2.85, "72": 3.50, "84": 4.09 },
                        "10%": { "48": 1.75, "60": 2.40, "72": 2.95, "84": 3.70 },
                        "15%": { "48": 0.90, "60": 1.65, "72": 2.30, "84": 2.90 },
                        "20%": { "48": 0.39, "60": 1.15, "72": 1.65, "84": 2.30 },
                        "25%": { "48": 0, "60": 0, "72": 1.45, "84": 2.09 }
                    }
                }
            },
            
            customerPrograms: {
                "TLT_A_Grade": {
                    description: "‡πÅ‡∏Ñ‡∏°‡πÄ‡∏õ‡∏ç‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏î‡∏µ TLT A-Grade",
                    interestDiscount: 0.20,
                    benefits: "‡∏î‡∏≤‡∏ß‡∏ô‡πå‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î 0% (Hilux Champ 5%), ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏ú‡∏π‡πâ‡∏Ñ‡πâ‡∏≥"
                },
                "Kubota_A_Grade": {
                    description: "‡πÅ‡∏Ñ‡∏°‡πÄ‡∏õ‡∏ç‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏î‡∏µ Kubota A-Grade",
                    interestDiscount: 0.20,
                    benefits: "‡∏î‡∏≤‡∏ß‡∏ô‡πå‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î 0% (Hilux Champ 5%), ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏ú‡∏π‡πâ‡∏Ñ‡πâ‡∏≥"
                },
                "Buy_More": {
                    description: "‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏° Buy More",
                    interestDiscount: 0.15,
                    benefits: "‡∏î‡∏≤‡∏ß‡∏ô‡πå‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î 0% (Hilux Champ 5%), ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏ú‡∏π‡πâ‡∏Ñ‡πâ‡∏≥ ‡∏´‡∏£‡∏∑‡∏≠ ‡∏Ç‡∏±‡∏ö‡∏ü‡∏£‡∏µ 60‡∏ß‡∏±‡∏ô"
                },
                "Buy_Easy": {
                    description: "‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏° Buy Easy",
                    interestDiscount: 0.15,
                    benefits: "‡∏î‡∏≤‡∏ß‡∏ô‡πå‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î 0% (Hilux Champ 5%), ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏ú‡∏π‡πâ‡∏Ñ‡πâ‡∏≥ ‡∏´‡∏£‡∏∑‡∏≠ ‡∏Ç‡∏±‡∏ö‡∏ü‡∏£‡∏µ 60‡∏ß‡∏±‡∏ô"
                },
                "Household": {
                    description: "‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏ö‡πâ‡∏≤‡∏ô (Household)",
                    interestDiscount: 0.15,
                    benefits: "‡∏î‡∏≤‡∏ß‡∏ô‡πå‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î 0%, ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏ú‡∏π‡πâ‡∏Ñ‡πâ‡∏≥ ‡∏´‡∏£‡∏∑‡∏≠ ‡∏Ç‡∏±‡∏ö‡∏ü‡∏£‡∏µ 60‡∏ß‡∏±‡∏ô (‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏î‡∏≤‡∏ß‡∏ô‡πå 15%)"
                },
                "Special_Profession": {
                    description: "‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏≠‡∏≤‡∏ä‡∏µ‡∏û‡∏û‡∏¥‡πÄ‡∏®‡∏©",
                    interestDiscount: 0.30,
                    benefits: "‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢ 0.50% ‡∏´‡∏£‡∏∑‡∏≠ ‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢ 0.20% + ‡∏Ñ‡πà‡∏≤‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢ 10,000 ‡∏ö‡∏≤‡∏ó"
                }
            }
        };

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏≤‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡∏î‡∏≤‡∏ß‡∏ô‡πå‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢
        function findMinimumDownPaymentPercent(actualPercent, model, term, promotion = null) {
            const availablePercents = [5, 10, 15, 20, 25];
            
            // ‡∏´‡∏≤‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ ‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢
            for (let percent of availablePercents) {
                if (percent >= actualPercent) {
                    const rate = getInterestRate(model, percent, term, promotion);
                    if (rate !== null) {
                        return percent;
                    }
                }
            }
            
            // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏û‡∏ö ‡πÉ‡∏´‡πâ‡∏´‡∏≤‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡πÉ‡∏î‡πÜ ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢
            for (let percent of availablePercents) {
                const rate = getInterestRate(model, percent, term, promotion);
                if (rate !== null) {
                    return percent;
                }
            }
            
            return null; // ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡πÄ‡∏•‡∏¢
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡πÄ‡∏á‡∏¥‡∏ô‡∏î‡∏≤‡∏ß‡∏ô‡πå
        function updateDownPaymentPercentage() {
            const price = parseFloat(document.getElementById('carPrice').value);
            const downPayment = parseFloat(document.getElementById('downPayment').value);
            const model = document.getElementById('carModel').value;
            const term = parseInt(document.getElementById('loanTerm').value);
            const percentageDiv = document.getElementById('downPaymentPercentage');
            
            if (price && downPayment && price > 0 && model && term) {
                const actualPercent = (downPayment / price * 100).toFixed(1);
                
                // ‡∏´‡∏≤ promotions ‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ß‡πâ
                const selectedPromotions = [];
                document.querySelectorAll('input[type="checkbox"]:checked').forEach(checkbox => {
                    if (!checkbox.value.includes('_Grade') && !checkbox.value.includes('_More') && 
                        !checkbox.value.includes('_Easy') && checkbox.value !== 'Household' && 
                        checkbox.value !== 'Special_Profession') {
                        selectedPromotions.push(checkbox.value);
                    }
                });
                
                const minPercent = findMinimumDownPaymentPercent(parseFloat(actualPercent), model, term, selectedPromotions[0]);
                
                if (minPercent === null) {
                    percentageDiv.textContent = `‡∏Ñ‡∏¥‡∏î‡πÄ‡∏õ‡πá‡∏ô ${actualPercent}% | ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ${model} ‡∏á‡∏ß‡∏î ${term} ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô`;
                    percentageDiv.style.color = '#d32f2f';
                    return;
                }
                
                const criteriaAmount = Math.round(price * minPercent / 100);
                const difference = criteriaAmount - downPayment;
                
                let displayText = `‡∏Ñ‡∏¥‡∏î‡πÄ‡∏õ‡πá‡∏ô ${actualPercent}% ‚Üí ‡πÉ‡∏ä‡πâ‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ ${minPercent}% (${criteriaAmount.toLocaleString()} ‡∏ö‡∏≤‡∏ó)`;
                
                if (difference > 100) {
                    displayText += ` | ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏á‡∏¥‡∏ô ${difference.toLocaleString()} ‡∏ö‡∏≤‡∏ó`;
                    percentageDiv.style.color = '#d32f2f';
                } else if (difference <= 0) {
                    displayText += ` | ‡∏á‡∏ö‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠`;
                    percentageDiv.style.color = '#2e7d32';
                } else {
                    percentageDiv.style.color = '#666';
                }
                
                percentageDiv.textContent = displayText;
            } else {
                percentageDiv.textContent = '';
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏á‡∏ß‡∏î‡∏ï‡∏≤‡∏°‡∏£‡∏∏‡πà‡∏ô‡∏£‡∏ñ
        function updateAvailableTerms() {
            const carModel = document.getElementById('carModel').value;
            const termSelect = document.getElementById('loanTerm');
            
            // Clear existing options except first one
            termSelect.innerHTML = '<option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏á‡∏ß‡∏î --</option>';
            
            if (carModel && ToyotaLeasingSystem.standardRates[carModel]) {
                const availableTerms = new Set();
                const rates = ToyotaLeasingSystem.standardRates[carModel];
                
                Object.values(rates).forEach(termRates => {
                    Object.keys(termRates).forEach(term => {
                        availableTerms.add(term);
                    });
                });
                
                Array.from(availableTerms).sort((a, b) => parseInt(a) - parseInt(b)).forEach(term => {
                    const option = document.createElement('option');
                    option.value = term;
                    const years = Math.floor(term / 12);
                    const remainingMonths = term % 12;
                    let yearText = years > 0 ? `${years} ‡∏õ‡∏µ` : '';
                    if (remainingMonths > 0) {
                        yearText += yearText ? ` ${remainingMonths} ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô` : `${remainingMonths} ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô`;
                    }
                    option.textContent = `${term} ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (${yearText})`;
                    termSelect.appendChild(option);
                });
            }
            
            // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡∏î‡∏≤‡∏ß‡∏ô‡πå
            updateDownPaymentPercentage();
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏≤‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢
        function getInterestRate(model, downPayment, term, promotion = null) {
            const key = downPayment + "%";
            const termStr = term.toString();
            
            if (promotion && ToyotaLeasingSystem.specialPromotions[promotion]) {
                const promo = ToyotaLeasingSystem.specialPromotions[promotion];
                if (promo.models.includes(model)) {
                    return promo.rates[key]?.[termStr] || null;
                }
            }
            
            return ToyotaLeasingSystem.standardRates[model]?.[key]?.[termStr] || null;
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î
        function calculateMonthlyPayment(principal, annualRate, months) {
            if (annualRate === 0) return Math.round(principal / months);
            
            const monthlyRate = annualRate / 100 / 12;
            const payment = principal * (monthlyRate * Math.pow(1 + monthlyRate, months)) / 
                           (Math.pow(1 + monthlyRate, months) - 1);
            return Math.round(payment);
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÉ‡∏ä‡πâ‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î‡∏à‡∏≤‡∏Å‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤
        function applyCustomerDiscount(baseRate, programs) {
            let totalDiscount = 0;
            programs.forEach(program => {
                if (ToyotaLeasingSystem.customerPrograms[program]) {
                    totalDiscount += ToyotaLeasingSystem.customerPrograms[program].interestDiscount;
                }
            });
            return Math.max(baseRate - totalDiscount, 0);
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏≤‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏ï‡∏≤‡∏°‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
        function findBestConditions(model, price, targetPayment) {
            const suggestions = [];
            const downPaymentAmounts = [
                price * 0.05, price * 0.10, price * 0.15, 
                price * 0.20, price * 0.25, price * 0.30
            ];
            const terms = [48, 60, 72, 84, 96, 108];
            
            downPaymentAmounts.forEach(downPaymentAmount => {
                const downPaymentPercent = (downPaymentAmount / price) * 100;
                
                terms.forEach(term => {
                    const minPercent = findMinimumDownPaymentPercent(downPaymentPercent, model, term, null);
                    
                    if (minPercent !== null) {
                        const criteriaAmount = Math.round(price * minPercent / 100);
                        const loanAmount = price - criteriaAmount;
                        const rate = getInterestRate(model, minPercent, term);
                        
                        if (rate !== null && loanAmount > 0) {
                            const monthlyPayment = calculateMonthlyPayment(loanAmount, rate, term);
                            const difference = Math.abs(monthlyPayment - targetPayment);
                            const additionalBudget = Math.max(criteriaAmount - downPaymentAmount, 0);
                            
                            suggestions.push({
                                downPaymentAmount: Math.round(downPaymentAmount),
                                downPaymentPercent: minPercent,
                                criteriaAmount,
                                additionalBudget,
                                term,
                                rate,
                                monthlyPayment,
                                difference,
                                loanAmount
                            });
                        }
                    }
                });
            });
            
            return suggestions.sort((a, b) => a.difference - b.difference).slice(0, 3);
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì
        function calculateFinancing() {
            const model = document.getElementById('carModel').value;
            const price = parseFloat(document.getElementById('carPrice').value);
            const downPaymentAmount = parseFloat(document.getElementById('downPayment').value);
            const term = parseInt(document.getElementById('loanTerm').value);
            const targetPayment = parseFloat(document.getElementById('monthlyPayment').value);
            
            const resultsDiv = document.getElementById('results');
            
            // Validation
            if (!model || !price || price < 50000) {
                resultsDiv.innerHTML = `
                    <div class="error-message">
                        ‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô (‡∏£‡∏∏‡πà‡∏ô‡∏£‡∏ñ ‡πÅ‡∏•‡∏∞ ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ñ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ 50,000 ‡∏ö‡∏≤‡∏ó)
                    </div>
                `;
                return;
            }

            // ‡∏´‡∏≤‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏´‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏∏‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
            if (targetPayment && (!downPaymentAmount || !term)) {
                const suggestions = findBestConditions(model, price, targetPayment);
                
                if (suggestions.length > 0) {
                    let suggestionsHtml = `
                        <div class="result-card highlight">
                            <h3>üí° ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î ${targetPayment.toLocaleString()} ‡∏ö‡∏≤‡∏ó/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</h3>
                    `;
                    
                    suggestions.forEach((suggestion, index) => {
                        const additionalText = suggestion.additionalBudget > 0 ? 
                            ` (+${suggestion.additionalBudget.toLocaleString()} ‡∏ö‡∏≤‡∏ó)` : '';
                        suggestionsHtml += `
                            <div class="result-row">
                                <span class="result-label">‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà ${index + 1}: ‡∏á‡∏ö‡∏î‡∏≤‡∏ß‡∏ô‡πå ${suggestion.downPaymentAmount.toLocaleString()} ‡∏ö‡∏≤‡∏ó${additionalText} ‚Üí ${suggestion.downPaymentPercent}% ‡∏á‡∏ß‡∏î ${suggestion.term} ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</span>
                                <span class="result-value">${suggestion.monthlyPayment.toLocaleString()} ‡∏ö‡∏≤‡∏ó/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (‡∏ï‡πà‡∏≤‡∏á ${Math.abs(suggestion.monthlyPayment - targetPayment).toLocaleString()} ‡∏ö‡∏≤‡∏ó)</span>
                            </div>
                        `;
                    });
                    
                    suggestionsHtml += `
                        </div>
                        <div style="text-align: center; margin-top: 15px;">
                            <p>üîç ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏á‡∏ö‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÅ‡∏•‡∏∞‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏á‡∏ß‡∏î‡∏à‡∏≤‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡πâ‡∏≤‡∏á‡∏ï‡πâ‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô</p>
                        </div>
                    `;
                    
                    resultsDiv.innerHTML = suggestionsHtml;
                    return;
                }
            }

            if (!downPaymentAmount || !term) {
                resultsDiv.innerHTML = `
                    <div class="error-message">
                        ‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏á‡∏ö‡∏î‡∏≤‡∏ß‡∏ô‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏á‡∏ß‡∏î
                    </div>
                `;
                return;
            }

            // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏á‡∏ö‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ñ
            if (downPaymentAmount >= price) {
                resultsDiv.innerHTML = `
                    <div class="error-message">
                        ‚ùå ‡∏á‡∏ö‡∏î‡∏≤‡∏ß‡∏ô‡πå‡∏ï‡πâ‡∏≠‡∏á‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ñ
                    </div>
                `;
                return;
            }

            // ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡πÅ‡∏•‡∏∞‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
            const selectedPromotions = [];
            const selectedCustomerPrograms = [];
            
            document.querySelectorAll('input[type="checkbox"]:checked').forEach(checkbox => {
                if (checkbox.value.includes('_Grade') || checkbox.value.includes('_More') || 
                    checkbox.value.includes('_Easy') || checkbox.value === 'Household' || 
                    checkbox.value === 'Special_Profession') {
                    selectedCustomerPrograms.push(checkbox.value);
                } else {
                    selectedPromotions.push(checkbox.value);
                }
            });

            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡πÄ‡∏á‡∏¥‡∏ô‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÅ‡∏•‡∏∞‡∏´‡∏≤‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ
            const actualDownPaymentPercent = (downPaymentAmount / price) * 100;
            const minDownPaymentPercent = findMinimumDownPaymentPercent(actualDownPaymentPercent, model, term, selectedPromotions[0]);
            
            if (minDownPaymentPercent === null) {
                resultsDiv.innerHTML = `
                    <div class="error-message">
                        ‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ${model} ‡∏á‡∏ß‡∏î ${term} ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏Å‡∏±‡∏ö‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÉ‡∏î‡πÜ
                        <br>üí° ‡∏•‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∏‡πà‡∏ô‡∏£‡∏ñ‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏á‡∏ß‡∏î‡∏≠‡∏∑‡πà‡∏ô
                    </div>
                `;
                return;
            }
            
            const criteriaDownPaymentAmount = Math.round(price * minDownPaymentPercent / 100);
            
            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°
            const additionalBudgetNeeded = Math.max(criteriaDownPaymentAmount - downPaymentAmount, 0);

            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
            try {
                // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏¢‡∏≠‡∏î‡∏à‡∏±‡∏î‡πÑ‡∏ü‡πÅ‡∏ô‡∏ô‡∏ã‡πå‡∏à‡∏≤‡∏Å‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥
                const loanAmount = price - criteriaDownPaymentAmount;
                
                // ‡∏´‡∏≤‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô
                let interestRate = getInterestRate(model, minDownPaymentPercent, term, selectedPromotions[0]);
                
                if (interestRate === null) {
                    resultsDiv.innerHTML = `
                        <div class="error-message">
                            ‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ${model} ‡∏î‡∏≤‡∏ß‡∏ô‡πå ${minDownPaymentPercent}% ‡∏á‡∏ß‡∏î ${term} ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
                            <br>üí° ‡∏•‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏á‡∏ö‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô 5%, 10%, 15%, 20%, ‡∏´‡∏£‡∏∑‡∏≠ 25% ‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ñ
                        </div>
                    `;
                    return;
                }
                
                const originalRate = interestRate;
                
                // ‡πÉ‡∏ä‡πâ‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î‡∏à‡∏≤‡∏Å‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤
                if (selectedCustomerPrograms.length > 0) {
                    interestRate = applyCustomerDiscount(interestRate, selectedCustomerPrograms);
                }
                
                const totalDiscount = originalRate - interestRate;
                
                // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î
                const monthlyPayment = calculateMonthlyPayment(loanAmount, interestRate, term);
                const totalPayment = monthlyPayment * term;
                const totalInterest = totalPayment - loanAmount;
                
                // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
                let resultHtml = `
                    <div class="result-card">
                        <h3>üìã ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</h3>
                        <div class="result-row">
                            <span class="result-label">‡∏£‡∏∏‡πà‡∏ô‡∏£‡∏ñ:</span>
                            <span class="result-value">${model.replace('_', ' ')}</span>
                        </div>
                        <div class="result-row">
                            <span class="result-label">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ñ:</span>
                            <span class="result-value">${price.toLocaleString()} ‡∏ö‡∏≤‡∏ó</span>
                        </div>
                        <div class="result-row">
                            <span class="result-label">‡∏á‡∏ö‡∏î‡∏≤‡∏ß‡∏ô‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ:</span>
                            <span class="result-value">${downPaymentAmount.toLocaleString()} ‡∏ö‡∏≤‡∏ó (${actualDownPaymentPercent.toFixed(1)}%)</span>
                        </div>
                        <div class="result-row">
                            <span class="result-label">‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ:</span>
                            <span class="result-value">${criteriaDownPaymentAmount.toLocaleString()} ‡∏ö‡∏≤‡∏ó (${minDownPaymentPercent}%)</span>
                        </div>
                `;

                // ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°
                if (additionalBudgetNeeded > 0) {
                    resultHtml += `
                        <div class="result-card budget-analysis budget-deficit">
                            <h4>üí≥ ‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°</h4>
                            <div class="result-row">
                                <span class="result-label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°:</span>
                                <span class="result-value">${additionalBudgetNeeded.toLocaleString()} ‡∏ö‡∏≤‡∏ó</span>
                            </div>
                            <p style="margin-top: 10px; font-size: 0.9rem; color: #666;">‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ñ‡∏∂‡∏á‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏î‡∏≤‡∏ß‡∏ô‡πå‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ ${minDownPaymentPercent}% (${criteriaDownPaymentAmount.toLocaleString()} ‡∏ö‡∏≤‡∏ó)</p>
                        </div>
                    `;
                } else {
                    resultHtml += `
                        <div class="result-card budget-analysis budget-surplus">
                            <h4>‚úÖ ‡∏á‡∏ö‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠</h4>
                            <p style="margin-top: 10px; font-size: 0.9rem; color: #666;">‡∏á‡∏ö‡∏î‡∏≤‡∏ß‡∏ô‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ ${minDownPaymentPercent}%</p>
                        </div>
                    `;
                }

                resultHtml += `
                        <div class="result-row">
                            <span class="result-label">‡∏¢‡∏≠‡∏î‡∏à‡∏±‡∏î‡πÑ‡∏ü‡πÅ‡∏ô‡∏ô‡∏ã‡πå:</span>
                            <span class="result-value">${loanAmount.toLocaleString()} ‡∏ö‡∏≤‡∏ó</span>
                        </div>
                        <div class="result-row">
                            <span class="result-label">‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤:</span>
                            <span class="result-value">${term} ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</span>
                        </div>
                    </div>

                    <div class="result-card highlight">
                        <h3>üí∞ ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</h3>
                        <div class="result-row">
                            <span class="result-label">‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô:</span>
                            <span class="result-value">${originalRate}% ‡∏ï‡πà‡∏≠‡∏õ‡∏µ</span>
                        </div>
                `;
                
                if (totalDiscount > 0) {
                    resultHtml += `
                        <div class="result-row">
                            <span class="result-label">‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢:</span>
                            <span class="result-value">-${totalDiscount.toFixed(2)}%</span>
                        </div>
                        <div class="result-row">
                            <span class="result-label">‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢:</span>
                            <span class="result-value">${interestRate.toFixed(2)}% ‡∏ï‡πà‡∏≠‡∏õ‡∏µ</span>
                        </div>
                    `;
                }
                
                resultHtml += `
                        <div class="result-row">
                            <span class="result-label">‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô:</span>
                            <span class="result-value" style="font-size: 1.3rem; color: #d32f2f; font-weight: 800;">${monthlyPayment.toLocaleString()} ‡∏ö‡∏≤‡∏ó</span>
                        </div>
                        <div class="result-row">
                            <span class="result-label">‡∏¢‡∏≠‡∏î‡∏ä‡∏≥‡∏£‡∏∞‡∏£‡∏ß‡∏°:</span>
                            <span class="result-value">${totalPayment.toLocaleString()} ‡∏ö‡∏≤‡∏ó</span>
                        </div>
                        <div class="result-row">
                            <span class="result-label">‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏£‡∏ß‡∏°:</span>
                            <span class="result-value">${totalInterest.toLocaleString()} ‡∏ö‡∏≤‡∏ó</span>
                        </div>
                    </div>
                `;

                // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ
                if (selectedPromotions.length > 0 || selectedCustomerPrograms.length > 0) {
                    resultHtml += `<div class="result-card">
                        <h3>üéÅ ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ</h3>`;
                    
                    selectedPromotions.forEach(promo => {
                        const promoData = ToyotaLeasingSystem.specialPromotions[promo];
                        if (promoData) {
                            resultHtml += `
                                <div class="result-row">
                                    <span class="result-label">‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô:</span>
                                    <span class="result-value">${promoData.description}</span>
                                </div>
                            `;
                        }
                    });
                    
                    selectedCustomerPrograms.forEach(program => {
                        const programData = ToyotaLeasingSystem.customerPrograms[program];
                        if (programData) {
                            resultHtml += `
                                <div class="result-row">
                                    <span class="result-label">‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤:</span>
                                    <span class="result-value">${programData.description}</span>
                                </div>
                            `;
                        }
                    });
                    
                    resultHtml += `</div>`;
                }

                // ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
                if (targetPayment) {
                    const paymentDifference = monthlyPayment - targetPayment;
                    const diffClass = paymentDifference > 0 ? 'error-message' : 'success-message';
                    const diffText = paymentDifference > 0 ? '‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤' : '‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤';
                    
                    resultHtml += `
                        <div class="${diffClass}">
                            <h4>üéØ ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£</h4>
                            <p>‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÑ‡∏î‡πâ ${diffText} ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ ${Math.abs(paymentDifference).toLocaleString()} ‡∏ö‡∏≤‡∏ó</p>
                        </div>
                    `;
                }
                
                resultsDiv.innerHTML = resultHtml;
                
            } catch (error) {
                resultsDiv.innerHTML = `
                    <div class="error-message">
                        ‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì: ${error.message}
                    </div>
                `;
            }
        }

        // ‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
        function loadPromotions() {
            const promotionsDiv = document.getElementById('promotions-list');
            let promoHtml = '';
            
            Object.values(ToyotaLeasingSystem.specialPromotions).forEach(promo => {
                promoHtml += `
                    <div class="promo-card">
                        <div class="promo-title">${promo.description}</div>
                        <div class="promo-details">
                            <strong>‡∏£‡∏∏‡πà‡∏ô‡∏ó‡∏µ‡πà‡∏£‡πà‡∏ß‡∏°:</strong> ${promo.models.join(', ')}<br>
                            <strong>‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤:</strong> ${promo.period}<br>
                            <strong>‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö:</strong> ${promo.deliveryDeadline}<br>
                            <strong>‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏û‡∏¥‡πÄ‡∏®‡∏©:</strong> ${promo.conditions}
                        </div>
                    </div>
                `;
            });
            
            Object.values(ToyotaLeasingSystem.customerPrograms).forEach(program => {
                promoHtml += `
                    <div class="promo-card">
                        <div class="promo-title">${program.description}</div>
                        <div class="promo-details">
                            <strong>‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢:</strong> ${program.interestDiscount}%<br>
                            <strong>‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏û‡∏¥‡πÄ‡∏®‡∏©:</strong> ${program.benefits}
                        </div>
                    </div>
                `;
            });
            
            promotionsDiv.innerHTML = promoHtml;
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            loadPromotions();
            
            // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô checkbox ‡∏´‡∏•‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡πÉ‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô
            document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    if (this.checked) {
                        // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô ‡πÉ‡∏´‡πâ uncheck ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏≠‡∏∑‡πà‡∏ô
                        if (['Ativ_Yaris_2566', 'Fortuner_2567', 'Veloz_Special'].includes(this.value)) {
                            document.querySelectorAll('input[type="checkbox"]').forEach(other => {
                                if (other !== this && ['Ativ_Yaris_2566', 'Fortuner_2567', 'Veloz_Special'].includes(other.value)) {
                                    other.checked = false;
                                }
                            });
                        }
                    }
                    // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô
                    updateDownPaymentPercentage();
                });
            });

            // Event listener ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ñ, ‡∏£‡∏∏‡πà‡∏ô‡∏£‡∏ñ, ‡πÅ‡∏•‡∏∞‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏á‡∏ß‡∏î
            document.getElementById('carPrice').addEventListener('input', updateDownPaymentPercentage);
            document.getElementById('loanTerm').addEventListener('change', updateDownPaymentPercentage);
        });
    </script>
</body>
</html>
